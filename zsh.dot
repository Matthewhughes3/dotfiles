export EDITOR=vi
export PATH=$PATH:~/bin
bindkey -v
export KEYTIMEOUT=1

function zle-line-init zle-keymap-select {
    RPS1="${${KEYMAP/vicmd/-- NORMAL --}/(main|viins)/-- INSERT --}"
    RPS2=$RPS1
    zle reset-prompt
}

zle -N zle-line-init
zle -N zle-keymap-select

zstyle ':completion:*' menu select
zstyle ':completion::complete:*' gain-privileges 1

alias ga="git commit -a; git push"
alias gs="git status"
alias re="source ~/.zshrc"
alias dotz="vim ~/dotfiles/zsh.dot"
alias dotv="vim ~/dotfiles/vim.dot"
alias doti="vim ~/dotfiles/i3.dot"
alias dott="vim ~/dotfiles/tmux.dot"

setopt COMPLETE_ALIASES

PROMPT="
$fg[cyan]%m: $fg[yellow]$(get_pwd)$(put_spacing)$(git_prompt_info)
$reset_color→ "

function get_pwd() {
	echo "${PWD/$HOME/~}"
}


function  put_spacing() {
	local git=$(git_prompt_info)
	if[ ${#git} != 0 ] 
	then
		((git=${#git} - 10))
	else
		git=0
	fi

	local termwidth
	(( termwidth = ${COLUMNS} - 3 - ${#HOST} - ${#$(get_pwd)} - ${bat} - ${git} ))

	local spacing=""
	for i in {1..$termwidth}
   	do
	    spacing="${spacing} "
	done
	echo $spacing
}

function git_prompt_info() {
	ref=$(git symbolic-ref HEAD 2> /dev/null) || return
	echo "$(parse_git_dirty)$ZSH_THEME_GIT_PROMPT_PREFIX$(current_branch)$ZSH_THEME_GIT_PROMPT_SUFFIX"
}
